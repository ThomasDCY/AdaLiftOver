getwd()
library(motifmatchr)
sessionInfo()
library(rtracklayer)
sessionInfo()
library(roxygen2)
document()
library(devtools)
document()
document()
document()
document()
document()
library(devtools)
getwd()
document()
document()
load_all()
ls()
?adaptive_liftover
document()
rm(list = ls())
load_all()
?compute_similarity_grammar
load('data_example.RData')
load('jaspar_pfm_list.RData')
gr_target_list <- compute_similarity_grammar(gr, gr_list, 'mm10', 'hg38', jaspar_pfm_list)
load('data_example.RData')
load('jaspar_pfm_list.RData')
gr_target_list <- compute_similarity_grammar(gr, gr_list, 'mm10', 'hg19', jaspar_pfm_list)
jaspar_pfm_list
gr
gr_list
gr_list_score
compute_similarity_grammar(gr, gr_list, 'mm10', 'hg19', jaspar_pfm_list)
length(gr)
length(gr_list)
compute_similarity_grammar(gr[1], gr_list[1], 'mm10', 'hg19', jaspar_pfm_list)
load_all()
compute_similarity_grammar(gr[1], gr_list[1], 'mm10', 'hg19', jaspar_pfm_list)
compute_similarity_grammar(gr, gr_list, 'mm10', 'hg19', jaspar_pfm_list)
unlist(gr_list)
?rowSums
load_all()
compute_similarity_grammar(gr, gr_list, 'mm10', 'hg19', jaspar_pfm_list)
library(SummarizedExperiment)
compute_similarity_grammar(gr, gr_list, 'mm10', 'hg19', jaspar_pfm_list)
load_all()
library(devtools)
load_all()
?compute_similarity_grammar
gr_target_list <- compute_similarity_grammar(gr, gr_list, 'mm10', 'hg38', jaspar_pfm_list)
gr_target_list <- compute_similarity_grammar(gr, gr_list, 'mm10', 'hg19', jaspar_pfm_list)
compute_grammar_matrix(gr, jaspar_pfm_list, 'mm10')
q_mat <- compute_grammar_matrix(gr, jaspar_pfm_list, 'mm10')
lengths(gr_list)
gr[rep(1:length(gr), lengths(gr_list))]
gr_q_flat <- gr[rep(1:length(gr), lengths(gr_list))]
gr_t_flat <- unlist(gr_list)
gr_q_flat
gr_t_flat
compute_similarity_grammar_flat(gr_q_flat, gr_t_flat, 'mm10', 'hg19')
compute_similarity_grammar_flat(gr_q_flat, gr_t_flat, 'mm10', 'hg19', jaspar_pfm_list)
q_mat <- compute_grammar_matrix(gr_q_flat, jaspar_pfm_list, 'mm10')
t_mat <- compute_grammar_matrix(gr_t_flat, jaspar_pfm_list, 'hg19')
q_mat
t_mat
compute_similarity_from_matrix(q_mat, t_mat)
nrow(q_mat)
nrow(t_mat)
rowSums(q_mat)
rowSums(t_mat)
rowSums(q_mat & t_mat)
compute_similarity_from_matrix(q_mat, t_mat)
compute_similarity_from_matrix(q_mat, t_mat)
compute_similarity_from_matrix(q_mat, t_mat)
compute_similarity_from_matrix()
compute_similarity_from_matrix
as.matrix(q_mat)
compute_similarity_from_matrix(q_mat, t_mat)
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
compute_similarity_from_matrix(q_mat, t_mat)
dim(q_mat)
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
library(Matrix)
compute_similarity_from_matrix(q_mat, t_mat)
compute_similarity_from_matrix(q_mat, t_mat)
?rowSums
q_mat
rowSums(q_mat)
rowSums(t_mat)
compute_similarity_from_matrix(q_mat, t_mat)
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
q_mat
compute_similarity_from_matrix(as.matrix(q_mat), as.matrix(t_mat))
class(q_mat)
rowSums(q_mat)
base::rowSums(q_mat)
Matrix::rowSums(q_mat)
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
compute_similarity_from_matrix(q_mat, t_mat)
document()
load_all()
compute_similarity_from_matrix(q_mat, t_mat)
compute_similarity_grammar(gr, gr_list, 'mm10', 'hg38', jaspar_pfm_list)
compute_similarity_grammar(gr, gr_list, 'mm10', 'hg19', jaspar_pfm_list)
gr_list_score
sessionInfo()
library(Matrix)
sessionInfo()
document()
document()
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("BSgenome.Hsapiens.UCSC.hg38")
library(devtools)
document()
data('data_example.RData')
data('data/data_example.RData')
data("data_example")
ls()
chain <- import.chain('~/Downloads/mm10.hg38.rbest.chain')
gr_target_list <- adaptive_liftover(gr, chain, window = 2000)
gr_target_list
ls()
gr_list
gr_target_list <- adaptive_liftover(gr, chain, step_size = 10000L, window = 2000)
gr_target_list
gr_list
gr_list[[4]]
gr_target_list[[4]]
gr_target_list[[5]]
gr_list[[5]]
gr_list
gr
gr_list
gr
gr_target_list
liftOver(gr[2], chain)
chain
gr_target_list <- adaptive_liftover(gr, chain, step_size = 10000L, window = 2000)
gr_target_list
gr_target_list <- adaptive_liftover(gr[1:2], chain, step_size = 10000L, window = 2000)
gr_target_list
gr_list[1:2]
liftOver(gr_list[2], chain)
liftOver(gr_list[1], chain)
liftOver(gr_list[2] + 2000, chain)
liftOver(gr_list[1] + 2000, chain)
gr_lsit
gr_list
liftOver(gr_list[[2]] + 2000, chain)
liftOver(gr_list[[1]] + 2000, chain)
gr_list[[2]]
liftOver(gr[2] + 2000, chain)
liftOver(gr[1] + 2000, chain)
sessionInfo()
ls()
gr
load_all()
ls()
data('data_example')
chain
gr
gr_target_list <- adaptive_liftover(gr, chain, window = 2000, step_size = 10000)
gr_target_list
gr_list
ls()
data("epigenome_hg38")
data("epigenome_mm10")
gr_target_list <- compute_similarity_epigenome(gr, gr_list, epigenome_mm10, epigenome_hg38)
gr
gr_list
load_all()
data('data_example')
gr
gr_list
gr_target_list <- compute_similarity_epigenome(gr, gr_list, epigenome_mm10, epigenome_hg38)
gr_target_list
gr_list_score
similarity <- compute_similarity_epigenome_flat(gr, unlist(gr_list), epigenome_mm10, epigenome_hg38)
gr
gr_list
compute_similarity_epigenome_flat(gr, gr_list[[1]], epigenome_mm10, epigenome_hg38)
similarity <- compute_similarity_epigenome_flat(gr[2], gr_list[[2]], epigenome_mm10, epigenome_hg38)
similarity
data('jaspar_pfm_list')
similarity <- compute_similarity_grammar_flat(gr[2], gr_list[[2]], 'mm10', 'hg38', jaspar_pfm_list)
similarity
gr_target_list <- compute_similarity_grammar(gr, gr_list, 'mm10', 'hg38', jaspar_pfm_list)
gr_target_list
gr_list
gr_list_score
gr_target_list
gr_list_filtered <- gr_candidate_filter(gr_list_score, threshold = 0.5)
gr_list_filtered
?gr_candidate_filter
?compute_similarity_epigenome
?compute_similarity_epigenome_flat
document()
?compute_similarity_epigenome_flat
?compute_similarity_grammar
?compute_similarity_grammar_flat
?adaptive_liftover
adaptive_liftover(gr[1], chain)
adaptive_liftover(gr[2], chain)
adaptive_liftover(gr[3], chain)
gr2 <- GRanges(
seqnames='chr4',
ranges=IRanges(start=c(1400, 2500, 10000), end=c(1600, 3000, 15000)),
strand='*'
)
gr2
adaptive_liftover(gr2, chain)
liftOver(gr2, chain)
as.data.table(liftOver(gr2, chain))
load_all()
liftOver(gr2, chain)
adaptive_liftover(gr2, chain)
adaptive_liftover(gr2[1], chain)
document()
library(devtools)
install()
